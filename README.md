The codes are heavily dependent on below gist
https://gist.github.com/santa4nt/4a8fd626335e36c94356